# ES440_cathode.py
import numpy as np

class ES440_cathode:
    def __init__(self, x_data, y_data, log_transform=False):
        self.x_data = np.array(x_data)
        self.y_data = np.array(y_data)
        self.log_transform = log_transform
        if self.log_transform:
            self.y_data = np.log10(self.y_data)

    def interpolate(self, x, inverse=False):
        if self.log_transform:
            x = np.log10(x) if not inverse else x
        if inverse:
            x_index, y_index = (self.y_data, self.x_data) if self.log_transform else (self.x_data, self.y_data)
            if x < min(x_index) or x > max(x_index):
                x = max(min(x_index), min(max(x_index), x))
            return np.interp(x, x_index, y_index)
        else:
            if x < min(self.x_data) or x > max(self.x_data):
                x = max(min(self.x_data), min(max(self.x_data), x))
            return np.exp10(np.interp(x, self.x_data, self.y_data)) if self.log_transform else np.interp(x, self.x_data, self.y_data)
    
    # Data: tuple of (heater current [A], heater voltage [V])
    heater_voltage_current_data = [
        (0, 8.61260838995737E-05),
        (0.19640028122802944, 0.01198382938832876),
        (0.44874150456995565, 0.023881532692758167),
        (1.0892898992266233, 0.05362784157487677),
        (2.234586360440591, 0.1101306538551674),
        (3.3024513709866423, 0.17253925474572274),
        (3.8852214670728844, 0.22003984063744997),
        (4.604776189360207, 0.31494668385282365),
        (4.974314506679168, 0.36536325287086924),
        (5.168943051324117, 0.3979763299742205),
        (5.324527771267871, 0.41873681743613766),
        (5.557937661120226, 0.4513580970236697),
        (5.635762831028828, 0.463218889149285),
        (5.888563393484885, 0.4958442699789076),
        (6.102582610733537, 0.5284614483243493),
        (6.277623623154442, 0.5521871338176703),
        (6.588924302788847, 0.599630302320131),
        (7.367176001874855, 0.7182382235762828),
        (7.9898429810171105, 0.8160856573705177),
        (8.067733770799158, 0.8309075462854463),
        (8.593250527302555, 0.9198511835012888),
        (9.041204593391143, 1.0087784157487696),
        (9.488896179985941, 1.0858612608389966),
        (9.995153503632531, 1.1807229903913754),
        (10.520801499882824, 1.2755888211858446),
        (11.066037028357162, 1.379342043590344),
        (11.572163112256854, 1.4682815795640962),
        (12.020117178345444, 1.557208811811577),
        (12.252542770096086, 1.5454153639594091),
        (12.40845558940708, 1.5809796109678929)
    ]

    # Data: tuple of (heater current [A], emission current [A])
    heater_current_emission_current_data = [
        (6.074077478630732, 2.602617737334362e-7),
        (7.322436482321272, 0.00032425581425640033),
        (8.003364836830947, 0.0029902802524155517),
        (8.556962772307791, 0.009961505019335917),
        (9.018381201399954, 0.031198761449695012),
        (9.46787687307359, 0.0511143348344016),
        (9.963655222816886, 0.11758495540521557),
        (10.493947833113173, 0.254308065356711),
        (11.024201858433997, 0.517092024289675),
        (11.531189143549728, 0.7260583498622462),
        (12.003720045575665, 1.1895340673703183),
        (12.361074795840086, 1.9488671918765683)
    ]

    # Data: tuple of (heater current [A], true temperature [K])
    heater_current_true_temperature_data = [
        (6.060869565217391, 1038.1399484306926),
        (7.313768115942029, 1333.2657597581576),
        (8.002173913043478, 1456.3207966568862),
        (8.552898550724636, 1537.5869120654397),
        (9.007246376811594, 1621.2572241486619),
        (9.447826086956521, 1658.2946563528049),
        (9.957246376811595, 1717.4535431670668),
        (9.971014492753623, 1737.0925580154708),
        (10.494202898550723, 1806.0745087578907),
        (10.494202898550723, 1781.5346314572776),
        (11.017391304347825, 1870.1484840401884),
        (11.513043478260869, 1899.8524050858005),
        (11.994927536231883, 1951.6351026940515),
        (12.352898550724637, 2018.0777096114518),
        (12.366666666666665, 1991.0909575886901)
    ]
